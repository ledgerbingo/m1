<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DEO — Service Standard</title>
    <link rel="stylesheet" href="/site.css" />
  </head>
  <body>
    <div class="wrap">
      <div class="nav">
        <a class="brand" href="/">
          <div class="logo" aria-hidden="true"></div>
          <div class="brandTitle">
            <strong>DEO</strong>
            <span>Service standard</span>
          </div>
        </a>
        <div class="navLinks">
          <a class="pill" href="/">Home</a>
          <a class="pill" href="/standard">Service Standard</a>
          <a class="pill" href="/examples">Examples</a>
          <a class="pill" href="/catalog">Catalog</a>
          <a class="pill" href="/status">Status</a>
          <a class="btn primary" href="/examples#playground">Open Playground</a>
        </div>
      </div>

      <div class="hero">
        <div class="card">
          <div class="sectionTitle">Service Standard</div>
          <div class="h1">A minimal, reusable payment handshake for HTTP.</div>
          <p class="lead">
            DEO defines a small set of endpoints that let any client discover pricing, receive an HTTP 402 challenge,
            produce an on-chain proof, and retry the original request with a verifiable authorization.
            The goal is a consistent integration surface that works for agents and traditional SDKs.
          </p>

          <div class="section" style="display:flex; gap:10px; flex-wrap:wrap;">
            <a class="btn primary" href="#endpoints">Standard endpoints</a>
            <a class="btn" href="#handshake">402 handshake</a>
            <a class="btn" href="#live">Live service output</a>
          </div>

          <div class="section" style="margin-top: 10px;">
            <div class="pill">Discoverable pricing</div>
            <div class="pill">Proof-based access</div>
            <div class="pill">Fast or final settlement</div>
            <div class="pill">Receipts and audit history</div>
          </div>
        </div>

        <div class="card" style="padding: 0; overflow: hidden;">
          <img class="heroArt" src="/assets/deo-endpoints.svg" alt="DEO standard endpoints diagram" />
        </div>
      </div>

      <div id="endpoints" class="section">
        <div class="sectionTitle">Standard endpoints</div>
        <div class="card">
          <table class="table">
            <thead>
              <tr>
                <th>Endpoint</th>
                <th>Purpose</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><span class="k">GET /status</span></td>
                <td>Service configuration snapshot (chain, pricing, contract addresses).</td>
                <td>Useful for diagnostics and client bootstrapping.</td>
              </tr>
              <tr>
                <td><span class="k">GET /catalog</span></td>
                <td>Product discovery (price and access policy).</td>
                <td>Returns an <span class="k">x402</span> challenge header template and request examples.</td>
              </tr>
              <tr>
                <td><span class="k">GET/POST /verify</span></td>
                <td>Proof verifier (tx hash → accept/reject).</td>
                <td>Responds with <span class="k">fast</span> for pending transactions, <span class="k">final</span> for finalized ones.</td>
              </tr>
              <tr>
                <td><span class="k">GET/POST /receipt</span></td>
                <td>Returns a normalized receipt object for a proof.</td>
                <td>Receipts are designed for auditing, analytics, and support workflows.</td>
              </tr>
              <tr>
                <td><span class="k">GET /payments</span></td>
                <td>Payment history.</td>
                <td>In chain mode, reads on-chain events. In preview mode, returns representative history.</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div id="handshake" class="section">
        <div class="sectionTitle">HTTP 402 handshake</div>
        <div class="grid2">
          <div class="card">
            <div class="sectionTitle">The challenge</div>
            <p class="lead">
              A premium endpoint answers unauthenticated requests with <span class="k">402 Payment Required</span> plus
              <span class="k">WWW-Authenticate</span> describing the payment requirements and the facilitator used for verification.
            </p>
            <hr />
            <div class="k">Example challenge header</div>
            <pre style="margin-top: 10px;"><code id="challengeOut">(loading...)</code></pre>
            <div class="muted" style="margin-top: 10px;">
              Clients can attach proofs via <span class="k">X-Payment-Proof</span> or <span class="k">Authorization: x402 &lt;proof&gt;</span>.
            </div>
          </div>

          <div class="card" style="padding: 0; overflow: hidden;">
            <img class="heroArt" src="/assets/deo-flow.svg" alt="402 challenge to proof to unlock flow" />
          </div>
        </div>
      </div>

      <div class="section">
        <div class="grid2">
          <div class="card">
            <div class="sectionTitle">Client algorithm (recommended)</div>
            <pre><code>1. Fetch catalog and select a product.
2. Call the premium endpoint.
3. If response is 402:
   - parse WWW-Authenticate (x402)
   - submit the required on-chain payment
   - obtain the tx hash as proof
4. Optionally call /verify to check fast/final acceptance.
5. Retry the premium endpoint with X-Payment-Proof.
6. Fetch /receipt for a normalized audit record.
7. Use /payments for history.</code></pre>
          </div>

          <div class="card">
            <div class="sectionTitle">Server algorithm (recommended)</div>
            <pre><code>Premium endpoint:
- If no proof:
  - respond 402 + WWW-Authenticate: x402 ...
- If proof present:
  - validate the proof (fast or final)
  - respond 200 with the premium payload</code></pre>
            <div class="muted" style="margin-top: 10px;">
              DEO keeps the verification policy centralized so every premium endpoint can share one trust rule.
            </div>
          </div>
        </div>
      </div>

      <div id="live" class="section">
        <div class="sectionTitle">Live service output</div>
        <div class="grid2">
          <div class="card">
            <div class="k">GET /status</div>
            <pre style="margin-top: 10px;"><code id="statusOut">(loading...)</code></pre>
            <div class="section" style="display:flex; gap:10px; flex-wrap:wrap;">
              <a class="btn" href="/status">Open JSON</a>
            </div>
          </div>

          <div class="card">
            <div class="k">GET /catalog</div>
            <pre style="margin-top: 10px;"><code id="catalogOut">(loading...)</code></pre>
            <div class="section" style="display:flex; gap:10px; flex-wrap:wrap;">
              <a class="btn" href="/catalog">Open JSON</a>
            </div>
          </div>
        </div>
      </div>

      <div class="section">
        <div class="sectionTitle">Image prompts (optional)</div>
        <div class="card">
          <div class="muted" style="line-height: 1.7;">
            If you want additional marketing visuals beyond the included SVG diagrams, these prompts are designed to work well
            with modern image generation models.
          </div>
          <hr />
          <pre><code>1) "Bright fintech landing page hero illustration of an autonomous AI agent negotiating a paid API request, minimal gradient background, glassmorphism, clean vector style, high resolution"

2) "Diagram-like illustration showing HTTP 402 challenge, blockchain settlement proof, and receipt generation, white background, soft gradients, modern enterprise SaaS style"

3) "Abstract depiction of Movement blockchain finality with fast and final settlement layers, purple and cyan gradients, clean geometric shapes"

4) "Three-panel use-case illustration: paid data API, paid inference, paid automation tools, coherent brand palette, minimal vector icons"</code></pre>
        </div>
      </div>

      <div class="footer">
        DEO is designed to be composable: the standard endpoints are small, and the premium endpoints remain fully custom.
      </div>
    </div>

    <script>
      async function fetchJsonSafe(path) {
        const res = await fetch(path);
        const text = await res.text();
        let body;
        try { body = JSON.parse(text); } catch { body = { raw: text }; }
        return { status: res.status, body };
      }

      async function init() {
        const [st, cat] = await Promise.all([
          fetchJsonSafe("/status"),
          fetchJsonSafe("/catalog"),
        ]);

        const statusEl = document.getElementById("statusOut");
        const catalogEl = document.getElementById("catalogOut");
        const challengeEl = document.getElementById("challengeOut");

        statusEl.textContent = JSON.stringify(st.body, null, 2);
        catalogEl.textContent = JSON.stringify(cat.body, null, 2);
        challengeEl.textContent = String(cat?.body?.challenge_header || "(missing)");
      }

      init().catch(() => undefined);
    </script>
  </body>
</html>
